SQL implementation to explore the semantics
